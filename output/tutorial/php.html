<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="en-us" http-equiv="Content-Language" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="/static/images/favicon.ico" rel="shortcut icon" />
    <link href="/static/css/style.css" rel="stylesheet" type="text/css" />
    <link href="/static/css/codehilite.css" rel="stylesheet" type="text/css" />
    <link href="/static/css/bootstrap.css" media="screen, projection" rel="stylesheet" type="text/css" />
    <link href="/static/css/thrift.css" media="screen, projection" rel="stylesheet" type="text/css" />

    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap-dropdown.js"></script>
    <script src="/static/js/bootstrap-tab.js"></script>
    <script src="/static/js/thrift.js"></script>

    <title>Apache Thrift - PHP</title>
  </head>
  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="/">Apache Thrift &trade;</a>
      <div class="nav-collapse">
        <ul class="nav pull-right">
          <li><a href="/download">Download</a></li>
          <li><a href="/docs">Documentation</a></li>
          <li><a href="/developers">Developers</a></li>
          <li><a href="/lib">Libraries</a></li>
          <li><a href="/tutorial">Tutorial</a></li>
          <li><a href="/test">Test Suite</a></li>
          <li><a href="/about">About</a></li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Apache <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="http://www.apache.org/" target="_blank">Apache Home</a></li>
              <li><a href="http://www.apache.org/licenses/" target="_blank">Apache License v2.0</a></li>
              <li><a href="http://www.apache.org/foundation/sponsorship.html" target="_blank">Donate</a></li>
              <li><a href="http://www.apache.org/foundation/thanks.html" target="_blank">Thanks</a></li>
              <li><a href="http://www.apache.org/security/" target="_blank">Security</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <h2>PHP Tutorial</h2>

<h3>Introduction</h3>

<p>
All Apache Thrift tutorials require that you have:

<ol>
  <li>The Apache Thrift Compiler and Libraries, see <a href="/download">Download</a> and <a href="/docs/BuildingFromSource">Building from Source</a> for more details.</li>
  <li>Generated the <a href="https://github.com/apache/thrift/blob/master/tutorial/tutorial.thrift">tutorial.thrift</a> and <a href="https://github.com/apache/thrift/blob/master/tutorial/shared.thrift">shared.thrift</a> files:<br>
    <pre><code>thrift -r --gen php tutorial.thrift</code></pre>
  </li>
  <li>Followed all prerequisites listed below.</li>
</ol>

<h3 id="prerequisites">Prerequisites</h3>

<h3 id="client">Client</h3>

<div class="highlight"><pre class="codehilite"><code><span class="cp">&lt;?php</span>

<span class="kn">namespace</span> <span class="nn">tutorial\php</span><span class="p">;</span>

<span class="nb">error_reporting</span><span class="p">(</span><span class="kc">E_ALL</span><span class="p">);</span>

<span class="k">require_once</span> <span class="k">__DIR__</span><span class="mf">.</span><span class="s1">'/../../vendor/autoload.php'</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Thrift\ClassLoader\ThriftClassLoader</span><span class="p">;</span>

<span class="nv">$GEN_DIR</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">))</span><span class="mf">.</span><span class="s1">'/gen-php'</span><span class="p">;</span>

<span class="nv">$loader</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ThriftClassLoader</span><span class="p">();</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="nf">registerNamespace</span><span class="p">(</span><span class="s1">'Thrift'</span><span class="p">,</span> <span class="k">__DIR__</span> <span class="mf">.</span> <span class="s1">'/../../lib/php/lib'</span><span class="p">);</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="nf">registerNamespace</span><span class="p">(</span><span class="s1">'shared'</span><span class="p">,</span> <span class="nv">$GEN_DIR</span><span class="p">);</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="nf">registerNamespace</span><span class="p">(</span><span class="s1">'tutorial'</span><span class="p">,</span> <span class="nv">$GEN_DIR</span><span class="p">);</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="nf">register</span><span class="p">();</span>

<span class="cm">/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements. See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership. The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License. You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */</span>

<span class="kn">use</span> <span class="nc">Thrift\Protocol\TBinaryProtocol</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Thrift\Transport\TSocket</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Thrift\Transport\THttpClient</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Thrift\Transport\TBufferedTransport</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Thrift\Exception\TException</span><span class="p">;</span>

<span class="k">try</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">array_search</span><span class="p">(</span><span class="s1">'--http'</span><span class="p">,</span> <span class="nv">$argv</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$socket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">THttpClient</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="mi">8080</span><span class="p">,</span> <span class="s1">'/php/PhpServer.php'</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nv">$socket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TSocket</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="mi">9090</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nv">$transport</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TBufferedTransport</span><span class="p">(</span><span class="nv">$socket</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">);</span>
  <span class="nv">$protocol</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TBinaryProtocol</span><span class="p">(</span><span class="nv">$transport</span><span class="p">);</span>
  <span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">\tutorial\CalculatorClient</span><span class="p">(</span><span class="nv">$protocol</span><span class="p">);</span>

  <span class="nv">$transport</span><span class="o">-&gt;</span><span class="nf">open</span><span class="p">();</span>

  <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">ping</span><span class="p">();</span>
  <span class="k">print</span> <span class="s2">"ping()</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>

  <span class="nv">$sum</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
  <span class="k">print</span> <span class="s2">"1+1=</span><span class="nv">$sum</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>

  <span class="nv">$work</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">\tutorial\Work</span><span class="p">();</span>

  <span class="nv">$work</span><span class="o">-&gt;</span><span class="n">op</span> <span class="o">=</span> <span class="nc">\tutorial\Operation</span><span class="o">::</span><span class="no">DIVIDE</span><span class="p">;</span>
  <span class="nv">$work</span><span class="o">-&gt;</span><span class="n">num1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="nv">$work</span><span class="o">-&gt;</span><span class="n">num2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">calculate</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nv">$work</span><span class="p">);</span>
    <span class="k">print</span> <span class="s2">"Whoa! We can divide by zero?</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nc">\tutorial\InvalidOperation</span> <span class="nv">$io</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s2">"InvalidOperation: </span><span class="nv">$io-&gt;why</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nv">$work</span><span class="o">-&gt;</span><span class="n">op</span> <span class="o">=</span> <span class="nc">\tutorial\Operation</span><span class="o">::</span><span class="no">SUBTRACT</span><span class="p">;</span>
  <span class="nv">$work</span><span class="o">-&gt;</span><span class="n">num1</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
  <span class="nv">$work</span><span class="o">-&gt;</span><span class="n">num2</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="nv">$diff</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">calculate</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nv">$work</span><span class="p">);</span>
  <span class="k">print</span> <span class="s2">"15-10=</span><span class="nv">$diff</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>

  <span class="nv">$log</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getStruct</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="k">print</span> <span class="s2">"Log: </span><span class="nv">$log-&gt;value</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>

  <span class="nv">$transport</span><span class="o">-&gt;</span><span class="nf">close</span><span class="p">();</span>

<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nc">TException</span> <span class="nv">$tx</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">print</span> <span class="s1">'TException: '</span><span class="mf">.</span><span class="nv">$tx</span><span class="o">-&gt;</span><span class="nf">getMessage</span><span class="p">()</span><span class="mf">.</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</code></pre></div>
<p class="snippet_footer">This snippet was generated by Apache Thrift's <strong>source tree docs</strong>:
<a href="https://gitbox.apache.org/repos/asf?p=thrift.git;a=blob;hb=HEAD;f=tutorial/php/PhpClient.php">tutorial/php/PhpClient.php</a>
</p>

<h3 id="server">Server</h3>

<div class="highlight"><pre class="codehilite"><code><span class="cp">&lt;?php</span>

<span class="kn">namespace</span> <span class="nn">tutorial\php</span><span class="p">;</span>

<span class="nb">error_reporting</span><span class="p">(</span><span class="kc">E_ALL</span><span class="p">);</span>

<span class="k">require_once</span> <span class="k">__DIR__</span><span class="mf">.</span><span class="s1">'/../../vendor/autoload.php'</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Thrift\ClassLoader\ThriftClassLoader</span><span class="p">;</span>

<span class="nv">$GEN_DIR</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">))</span><span class="mf">.</span><span class="s1">'/gen-php'</span><span class="p">;</span>

<span class="nv">$loader</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ThriftClassLoader</span><span class="p">();</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="nf">registerNamespace</span><span class="p">(</span><span class="s1">'Thrift'</span><span class="p">,</span> <span class="k">__DIR__</span> <span class="mf">.</span> <span class="s1">'/../../lib/php/lib'</span><span class="p">);</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="nf">registerNamespace</span><span class="p">(</span><span class="s1">'shared'</span><span class="p">,</span> <span class="nv">$GEN_DIR</span><span class="p">);</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="nf">registerNamespace</span><span class="p">(</span><span class="s1">'tutorial'</span><span class="p">,</span> <span class="nv">$GEN_DIR</span><span class="p">);</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="nf">register</span><span class="p">();</span>

<span class="cm">/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements. See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership. The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License. You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */</span>

<span class="cm">/*
 * This is not a stand-alone server.  It should be run as a normal
 * php web script (like through Apache's mod_php) or as a cgi script
 * (like with the included runserver.py).  You can connect to it with
 * THttpClient in any language that supports it.  The PHP tutorial client
 * will work if you pass it the argument "--http".
 */</span>

<span class="k">if</span> <span class="p">(</span><span class="nb">php_sapi_name</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'cli'</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">ini_set</span><span class="p">(</span><span class="s2">"display_errors"</span><span class="p">,</span> <span class="s2">"stderr"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kn">use</span> <span class="nc">Thrift\Protocol\TBinaryProtocol</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Thrift\Transport\TPhpStream</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Thrift\Transport\TBufferedTransport</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">CalculatorHandler</span> <span class="kd">implements</span> <span class="nc">\tutorial\CalculatorIf</span> <span class="p">{</span>
  <span class="k">protected</span> <span class="nv">$log</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>

  <span class="k">public</span> <span class="k">function</span> <span class="n">ping</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">error_log</span><span class="p">(</span><span class="s2">"ping()"</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="k">function</span> <span class="n">add</span><span class="p">(</span><span class="nv">$num1</span><span class="p">,</span> <span class="nv">$num2</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">error_log</span><span class="p">(</span><span class="s2">"add(</span><span class="si">{</span><span class="nv">$num1</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nv">$num2</span><span class="si">}</span><span class="s2">)"</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$num1</span> <span class="o">+</span> <span class="nv">$num2</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="k">function</span> <span class="n">calculate</span><span class="p">(</span><span class="nv">$logid</span><span class="p">,</span> <span class="nc">\tutorial\Work</span> <span class="nv">$w</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">error_log</span><span class="p">(</span><span class="s2">"calculate(</span><span class="si">{</span><span class="nv">$logid</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nv">{$w-&gt;op</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nv">$w</span><span class="o">-&gt;</span><span class="n">num1</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nv">$w</span><span class="o">-&gt;</span><span class="n">num2</span><span class="si">}</span><span class="s2">})"</span><span class="p">);</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nv">$w</span><span class="o">-&gt;</span><span class="n">op</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="nc">\tutorial\Operation</span><span class="o">::</span><span class="no">ADD</span><span class="o">:</span>
        <span class="nv">$val</span> <span class="o">=</span> <span class="nv">$w</span><span class="o">-&gt;</span><span class="n">num1</span> <span class="o">+</span> <span class="nv">$w</span><span class="o">-&gt;</span><span class="n">num2</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="nc">\tutorial\Operation</span><span class="o">::</span><span class="no">SUBTRACT</span><span class="o">:</span>
        <span class="nv">$val</span> <span class="o">=</span> <span class="nv">$w</span><span class="o">-&gt;</span><span class="n">num1</span> <span class="o">-</span> <span class="nv">$w</span><span class="o">-&gt;</span><span class="n">num2</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="nc">\tutorial\Operation</span><span class="o">::</span><span class="no">MULTIPLY</span><span class="o">:</span>
        <span class="nv">$val</span> <span class="o">=</span> <span class="nv">$w</span><span class="o">-&gt;</span><span class="n">num1</span> <span class="o">*</span> <span class="nv">$w</span><span class="o">-&gt;</span><span class="n">num2</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="nc">\tutorial\Operation</span><span class="o">::</span><span class="no">DIVIDE</span><span class="o">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$w</span><span class="o">-&gt;</span><span class="n">num2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$io</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">\tutorial\InvalidOperation</span><span class="p">();</span>
          <span class="nv">$io</span><span class="o">-&gt;</span><span class="n">whatOp</span> <span class="o">=</span> <span class="nv">$w</span><span class="o">-&gt;</span><span class="n">op</span><span class="p">;</span>
          <span class="nv">$io</span><span class="o">-&gt;</span><span class="n">why</span> <span class="o">=</span> <span class="s2">"Cannot divide by 0"</span><span class="p">;</span>
          <span class="k">throw</span> <span class="nv">$io</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nv">$val</span> <span class="o">=</span> <span class="nv">$w</span><span class="o">-&gt;</span><span class="n">num1</span> <span class="o">/</span> <span class="nv">$w</span><span class="o">-&gt;</span><span class="n">num2</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">default</span><span class="o">:</span>
        <span class="nv">$io</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">\tutorial\InvalidOperation</span><span class="p">();</span>
        <span class="nv">$io</span><span class="o">-&gt;</span><span class="n">whatOp</span> <span class="o">=</span> <span class="nv">$w</span><span class="o">-&gt;</span><span class="n">op</span><span class="p">;</span>
        <span class="nv">$io</span><span class="o">-&gt;</span><span class="n">why</span> <span class="o">=</span> <span class="s2">"Invalid Operation"</span><span class="p">;</span>
        <span class="k">throw</span> <span class="nv">$io</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$log</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">\shared\SharedStruct</span><span class="p">();</span>
    <span class="nv">$log</span><span class="o">-&gt;</span><span class="n">key</span> <span class="o">=</span> <span class="nv">$logid</span><span class="p">;</span>
    <span class="nv">$log</span><span class="o">-&gt;</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="nv">$val</span><span class="p">;</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">log</span><span class="p">[</span><span class="nv">$logid</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$log</span><span class="p">;</span>

    <span class="k">return</span> <span class="nv">$val</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="k">function</span> <span class="n">getStruct</span><span class="p">(</span><span class="nv">$key</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">error_log</span><span class="p">(</span><span class="s2">"getStruct(</span><span class="si">{</span><span class="nv">$key</span><span class="si">}</span><span class="s2">)"</span><span class="p">);</span>
    <span class="c1">// This actually doesn't work because the PHP interpreter is</span>
    <span class="c1">// restarted for every request.</span>
    <span class="c1">//return $this-&gt;log[$key];</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nc">\shared\SharedStruct</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">"key"</span> <span class="o">=&gt;</span> <span class="nv">$key</span><span class="p">,</span> <span class="s2">"value"</span> <span class="o">=&gt;</span> <span class="s2">"PHP is stateless!"</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="k">function</span> <span class="n">zip</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">error_log</span><span class="p">(</span><span class="s2">"zip()"</span><span class="p">);</span>
  <span class="p">}</span>

<span class="p">};</span>

<span class="nb">header</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">,</span> <span class="s1">'application/x-thrift'</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">php_sapi_name</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'cli'</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="nv">$handler</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CalculatorHandler</span><span class="p">();</span>
<span class="nv">$processor</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">\tutorial\CalculatorProcessor</span><span class="p">(</span><span class="nv">$handler</span><span class="p">);</span>

<span class="nv">$transport</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TBufferedTransport</span><span class="p">(</span><span class="k">new</span> <span class="nc">TPhpStream</span><span class="p">(</span><span class="nc">TPhpStream</span><span class="o">::</span><span class="no">MODE_R</span> <span class="o">|</span> <span class="nc">TPhpStream</span><span class="o">::</span><span class="no">MODE_W</span><span class="p">));</span>
<span class="nv">$protocol</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TBinaryProtocol</span><span class="p">(</span><span class="nv">$transport</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="nv">$transport</span><span class="o">-&gt;</span><span class="nf">open</span><span class="p">();</span>
<span class="nv">$processor</span><span class="o">-&gt;</span><span class="nf">process</span><span class="p">(</span><span class="nv">$protocol</span><span class="p">,</span> <span class="nv">$protocol</span><span class="p">);</span>
<span class="nv">$transport</span><span class="o">-&gt;</span><span class="nf">close</span><span class="p">();</span>
</code></pre></div>
<p class="snippet_footer">This snippet was generated by Apache Thrift's <strong>source tree docs</strong>:
<a href="https://gitbox.apache.org/repos/asf?p=thrift.git;a=blob;hb=HEAD;f=tutorial/php/PhpServer.php">tutorial/php/PhpServer.php</a>
</p>

<h2 id="additional-information">Additional Information</h2>



    </div>
    <div class="container">
  <hr>
  <footer class="footer">
    <div class="row">
      <div class="span3">
        <h3>Links</h3>
        <ul class="unstyled">
          <li><a href="/download">Download</a></li>
          <li><a href="/developers">Developers</a></li>
          <li><a href="/tutorial">Tutorials</a></li>
        </ul>
        <ul class="unstyled">
          <li><a href="/sitemap">Sitemap</a></li>
        </ul>
      </div>
      <div class="span3">
        <h3>Get Involved</h3>
        <ul class="unstyled">
          <li><a href="/mailing">Mailing Lists</a></li>
          <li><a href="http://issues.apache.org/jira/browse/THRIFT">Issue Tracking</a></li>
          <li><a href="/docs/HowToContribute">How To Contribute</a></li>
        </ul>
      </div>
      <div class="span6">
        <a href="http://www.apache.org/"><img src="/static/images/feather.svg" onerror="this.src='/static/images/feather.png';this.onerror=null;" /></a>
        Copyright &copy; 2024 <a href="http://www.apache.org/">Apache Software Foundation</a>.
        Licensed under the <a href="http://www.apache.org/licenses/">Apache License v2.0</a>.
        Apache, Apache Thrift, and the Apache feather logo are trademarks of The Apache Software Foundation.
      </div>
    </div>
  </footer>
</div>

  </body>
</html>
